#include <iostream>
#include <cstring>

using namespace std;

int crc(string in, string key, string &sent, int len, int mode)
{
    string out;
    out = in;
    
   

    if (mode==1) {
        for (int i = 1; i < key.size(); i++)
            out.append("0");
    }
    
    
    for (int i = 0; i < len; i++) {
        
        if (out[i] == '1') {
            for (int j = 0; j < key.size(); j++) {
                if (out[i + j] == key[j])
                    out[i + j] = '0';
                else
                    out[i + j] = '1';
            }
            
        }
    }
    
    
    if(mode==1) 
        sent = in+out.substr(in.size(),key.size()-1);
        
    
    if(mode==2)
    {
       
        for (int i = 0; i < out.size(); i++)
            if (out[i] == '1') 
                return 0;
        cout << "Original Message: " << in.substr(0,in.size()-key.size()+1);
    }
    
    return 1;
}

int main()
{
    string data,recv,key,sent;
    int len;
    key = "1101";
    
    //Sender
    cout << "Enter the input message in binary"<< endl;
    cin >> data;
    len = data.size();
    crc(data, key, sent, len, 1);
    cout << "The transmitted message is: " << sent << endl;
    
    //Receiver
    cout << "Enter the recevied message in binary" << endl;
    cin >> recv;
    if (crc(recv, key, sent, len, 2))
        cout << "\nNo error in data" << endl;
    else
        cout << "\nError in data transmission has occurred" << endl;

    return 0;
} 
